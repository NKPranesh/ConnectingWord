"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.decode = decode;
exports.encode = encode;

var _gltfScenegraph = _interopRequireDefault(require("../api/gltf-scenegraph"));

var _gltfConstants = require("../gltf-utils/gltf-constants");

async function decode(gltfData) {
  const gltfScenegraph = new _gltfScenegraph.default(gltfData);
  const {
    json
  } = gltfScenegraph;
  gltfScenegraph.removeExtension(_gltfConstants.KHR_MATERIALS_UNLIT);

  for (const material of json.materials || []) {
    const extension = material.extensions && material.extensions.KHR_materials_unlit;

    if (extension) {
      material.unlit = true;
    }

    gltfScenegraph.removeObjectExtension(material, _gltfConstants.KHR_MATERIALS_UNLIT);
  }
}

function encode(gltfData) {
  const gltfScenegraph = new _gltfScenegraph.default(gltfData);
  const {
    json
  } = gltfScenegraph;

  if (gltfScenegraph.materials) {
    for (const material of json.materials || []) {
      if (material.unlit) {
        delete material.unlit;
        gltfScenegraph.addObjectExtension(material, _gltfConstants.KHR_MATERIALS_UNLIT, {});
        gltfScenegraph.addExtension(_gltfConstants.KHR_MATERIALS_UNLIT);
      }
    }
  }
}
//# sourceMappingURL=KHR_materials_unlit.js.map