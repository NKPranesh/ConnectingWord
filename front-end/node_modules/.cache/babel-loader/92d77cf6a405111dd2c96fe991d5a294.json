{"ast":null,"code":"function getStorage(type) {\n  try {\n    const storage = window[type];\n    const x = '__storage_test__';\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return storage;\n  } catch (e) {\n    return null;\n  }\n}\n\nexport default class LocalStorage {\n  constructor(id, defaultSettings) {\n    let type = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'sessionStorage';\n    this.storage = getStorage(type);\n    this.id = id;\n    this.config = {};\n    Object.assign(this.config, defaultSettings);\n\n    this._loadConfiguration();\n  }\n\n  getConfiguration() {\n    return this.config;\n  }\n\n  setConfiguration(configuration) {\n    this.config = {};\n    return this.updateConfiguration(configuration);\n  }\n\n  updateConfiguration(configuration) {\n    Object.assign(this.config, configuration);\n\n    if (this.storage) {\n      const serialized = JSON.stringify(this.config);\n      this.storage.setItem(this.id, serialized);\n    }\n\n    return this;\n  }\n\n  _loadConfiguration() {\n    let configuration = {};\n\n    if (this.storage) {\n      const serializedConfiguration = this.storage.getItem(this.id);\n      configuration = serializedConfiguration ? JSON.parse(serializedConfiguration) : {};\n    }\n\n    Object.assign(this.config, configuration);\n    return this;\n  }\n\n}","map":{"version":3,"sources":["../../../src/utils/local-storage.js"],"names":["storage","window","x","constructor","type","getStorage","Object","getConfiguration","setConfiguration","updateConfiguration","serialized","JSON","_loadConfiguration","configuration","serializedConfiguration"],"mappings":"AAoBA,SAAA,UAAA,CAAA,IAAA,EAA0B;AACxB,MAAI;AAGF,UAAMA,OAAO,GAAGC,MAAM,CAAtB,IAAsB,CAAtB;AACA,UAAMC,CAAC,GAAP,kBAAA;AACAF,IAAAA,OAAO,CAAPA,OAAAA,CAAAA,CAAAA,EAAAA,CAAAA;AACAA,IAAAA,OAAO,CAAPA,UAAAA,CAAAA,CAAAA;AACA,WAAA,OAAA;AAPF,GAAA,CAQE,OAAA,CAAA,EAAU;AACV,WAAA,IAAA;AACD;AACF;;AAGD,eAAe,MAAA,YAAA,CAAmB;AAChCG,EAAAA,WAAW,CAAA,EAAA,EAAA,eAAA,EAA+C;AAAA,QAAzBC,IAAyB,uEAA/C,gBAA+C;AACxD,SAAA,OAAA,GAAeC,UAAU,CAAzB,IAAyB,CAAzB;AACA,SAAA,EAAA,GAAA,EAAA;AACA,SAAA,MAAA,GAAA,EAAA;AACAC,IAAAA,MAAM,CAANA,MAAAA,CAAc,KAAdA,MAAAA,EAAAA,eAAAA;;AACA,SAAA,kBAAA;AACD;;AAEDC,EAAAA,gBAAgB,GAAG;AACjB,WAAO,KAAP,MAAA;AACD;;AAEDC,EAAAA,gBAAgB,CAAA,aAAA,EAAgB;AAC9B,SAAA,MAAA,GAAA,EAAA;AACA,WAAO,KAAA,mBAAA,CAAP,aAAO,CAAP;AACD;;AAEDC,EAAAA,mBAAmB,CAAA,aAAA,EAAgB;AACjCH,IAAAA,MAAM,CAANA,MAAAA,CAAc,KAAdA,MAAAA,EAAAA,aAAAA;;AACA,QAAI,KAAJ,OAAA,EAAkB;AAChB,YAAMI,UAAU,GAAGC,IAAI,CAAJA,SAAAA,CAAe,KAAlC,MAAmBA,CAAnB;AACA,WAAA,OAAA,CAAA,OAAA,CAAqB,KAArB,EAAA,EAAA,UAAA;AACD;;AACD,WAAA,IAAA;AACD;;AAGDC,EAAAA,kBAAkB,GAAG;AACnB,QAAIC,aAAa,GAAjB,EAAA;;AACA,QAAI,KAAJ,OAAA,EAAkB;AAChB,YAAMC,uBAAuB,GAAG,KAAA,OAAA,CAAA,OAAA,CAAqB,KAArD,EAAgC,CAAhC;AACAD,MAAAA,aAAa,GAAGC,uBAAuB,GAAGH,IAAI,CAAJA,KAAAA,CAAH,uBAAGA,CAAH,GAAvCE,EAAAA;AACD;;AACDP,IAAAA,MAAM,CAANA,MAAAA,CAAc,KAAdA,MAAAA,EAAAA,aAAAA;AACA,WAAA,IAAA;AACD;;AApC+B","sourcesContent":["// Copyright (c) 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nfunction getStorage(type) {\n  try {\n    /** @type {Storage} */\n    // @ts-ignore\n    const storage = window[type];\n    const x = '__storage_test__';\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return storage;\n  } catch (e) {\n    return null;\n  }\n}\n\n// Store keys in local storage via simple interface\nexport default class LocalStorage {\n  constructor(id, defaultSettings, type = 'sessionStorage') {\n    this.storage = getStorage(type);\n    this.id = id;\n    this.config = {};\n    Object.assign(this.config, defaultSettings);\n    this._loadConfiguration();\n  }\n\n  getConfiguration() {\n    return this.config;\n  }\n\n  setConfiguration(configuration) {\n    this.config = {};\n    return this.updateConfiguration(configuration);\n  }\n\n  updateConfiguration(configuration) {\n    Object.assign(this.config, configuration);\n    if (this.storage) {\n      const serialized = JSON.stringify(this.config);\n      this.storage.setItem(this.id, serialized);\n    }\n    return this;\n  }\n\n  // Get config from persistent store, if available\n  _loadConfiguration() {\n    let configuration = {};\n    if (this.storage) {\n      const serializedConfiguration = this.storage.getItem(this.id);\n      configuration = serializedConfiguration ? JSON.parse(serializedConfiguration) : {};\n    }\n    Object.assign(this.config, configuration);\n    return this;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}